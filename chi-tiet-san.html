<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Chi ti·∫øt s√¢n - SportField</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="assets/css/styles.css" />
  <style>
    .venue-hero {
      margin-bottom: 24px;
    }

    .venue-gallery {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 12px;
      border-radius: 16px;
      overflow: hidden;
      min-height: 450px;
      max-height: 600px;
      height: 500px;
      align-items: stretch;
    }

    .gallery-main {
      width: 100%;
      height: 100%;
      object-fit: cover;
      background: #f3f4f6;
      display: block;
      border-radius: 12px;
    }

    .gallery-thumbs {
      display: grid;
      grid-template-rows: 1fr 1fr;
      gap: 12px;
      height: 100%;
      min-height: 100%;
      align-content: stretch;
    }

    .gallery-thumb {
      width: 100%;
      height: 100%;
      min-height: 0;
      object-fit: cover;
      cursor: pointer;
      opacity: 0.85;
      transition: all 0.2s ease;
      border-radius: 8px;
      background: #f3f4f6;
      border: 2px solid transparent;
      display: block;
    }

    .gallery-thumb:hover {
      opacity: 1;
      transform: scale(1.02);
      border-color: var(--green);
    }

    .venue-info {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 24px;
      margin-top: 24px;
    }

    .venue-title {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .venue-subtitle {
      display: flex;
      align-items: center;
      gap: 16px;
      font-size: 14px;
      color: var(--muted);
      margin-bottom: 16px;
    }

    .venue-rating {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-weight: 600;
      color: #f59e0b;
    }

    .venue-tags {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 24px;
    }

    .venue-tag {
      padding: 6px 12px;
      border-radius: 999px;
      background: #e0f2fe;
      color: #1e40af;
      font-size: 12px;
      font-weight: 600;
    }

    .venue-details-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
      margin-bottom: 24px;
    }

    .detail-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
    }

    .detail-icon {
      width: 20px;
      height: 20px;
      color: var(--green);
    }

    .booking-card {
      position: sticky;
      top: 80px;
      background: var(--white);
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .booking-price {
      font-size: 32px;
      font-weight: 700;
      color: var(--green-dark);
      margin-bottom: 8px;
    }

    .booking-price-unit {
      font-size: 14px;
      color: var(--muted);
      font-weight: normal;
    }

    .booking-cta {
      width: 100%;
      margin-top: 16px;
      padding: 14px;
      font-size: 16px;
    }

    .section-content {
      line-height: 1.8;
      color: var(--text);
    }

    .reviews-section {
      margin-top: 32px;
    }

    .review-card {
      border-bottom: 1px solid var(--border);
      padding: 16px 0;
    }

    .review-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .review-author {
      font-weight: 600;
      font-size: 14px;
    }

    .review-date {
      font-size: 12px;
      color: var(--muted);
    }

    @media (max-width: 968px) {
      .venue-info {
        grid-template-columns: 1fr;
      }

      .booking-card {
        position: static;
      }

      .venue-gallery {
        grid-template-columns: 1fr;
        height: auto;
        min-height: 350px;
        max-height: 500px;
      }

      .gallery-main {
        height: 350px;
        min-height: 350px;
      }

      .gallery-thumbs {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: 1fr;
        height: 150px;
        min-height: 150px;
      }

      .gallery-thumb {
        height: 150px;
      }
    }

    @media (max-width: 640px) {
      .venue-gallery {
        min-height: 280px;
        max-height: 400px;
      }

      .gallery-main {
        height: 280px;
        min-height: 280px;
      }

      .gallery-thumbs {
        height: 120px;
        min-height: 120px;
      }

      .gallery-thumb {
        height: 120px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="container header-inner">
      <div class="logo-wrap">
        <a href="index.html">
          <svg class="logo-icon" viewBox="0 0 64 64" aria-hidden="true">
            <defs>
              <linearGradient id="sf-pin" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0%" stop-color="#16a34a" />
                <stop offset="100%" stop-color="#15803d" />
              </linearGradient>
            </defs>
            <path d="M32 4C22 4 14 12 14 22.2c0 11.2 9.7 22.3 16.2 30 1 1.2 2.7 1.2 3.7 0C40.3 44.5 50 33.4 50 22.2 50 12 42 4 32 4Z" fill="none" stroke="url(#sf-pin)" stroke-width="4" />
            <path d="M18 26h28" stroke="#16a34a" stroke-width="3" stroke-linecap="round" />
            <path d="M32 26v16" stroke="#16a34a" stroke-width="3" stroke-linecap="round" />
            <path d="M24 18l5 5 9-9" fill="none" stroke="#2563eb" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
          <div class="brand-name">SportField</div>
        </a>
      </div>

      <nav>
        <a href="index.html">Trang ch·ªß</a>
        <div class="nav-dropdown">
          <a href="danh-sach-san.html" class="active">M√¥n th·ªÉ thao</a>
          <div class="dropdown-menu">
            <a href="danh-sach-san.html?sportType=football">B√≥ng ƒë√°</a>
            <a href="danh-sach-san.html?sportType=badminton">C·∫ßu l√¥ng</a>
            <a href="danh-sach-san.html?sportType=tennis">Tennis</a>
          </div>
        </div>
        <a href="uu-dai.html">∆Øu ƒë√£i</a>
        <a href="doi-tac.html">D√†nh cho ƒë·ªëi t√°c</a>
        <a href="tin-tuc.html">Tin t·ª©c</a>
        <div class="nav-dropdown">
          <a href="ho-tro.html">H·ªó tr·ª£</a>
          <div class="dropdown-menu">
            <a href="ho-tro.html">H·ªó tr·ª£ & FAQ</a>
            <a href="dieu-khoan.html">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a>
          </div>
        </div>
      </nav>

      <div class="header-cta">
        <a href="dang-nhap.html" class="btn-outline">ƒêƒÉng nh·∫≠p</a>
        <a href="dang-ky.html" class="btn">ƒêƒÉng k√Ω</a>
      </div>
    </div>
  </header>

  <main>
    <div class="container">
      <!-- Breadcrumb -->
      <div style="padding: 16px 0; font-size: 13px; color: var(--muted);" id="breadcrumb">
        <a href="index.html">Trang ch·ªß</a> / 
        <a href="danh-sach-san.html">Danh s√°ch s√¢n</a> / 
        <span id="breadcrumb-venue">ƒêang t·∫£i...</span>
      </div>

      <div class="venue-hero" id="venue-hero">
        <div class="venue-gallery">
          <div style="position: relative; width: 100%; height: 100%; overflow: hidden; border-radius: 12px; background: #f3f4f6;">
            <img src="" alt="S√¢n th·ªÉ thao" class="gallery-main" id="main-image" />
          </div>
          <div class="gallery-thumbs" id="gallery-thumbs">
            <!-- Thumbnails will be loaded here -->
          </div>
        </div>
      </div>

      <div class="venue-info" id="venue-info">
        <div>
          <h1 class="venue-title" id="venue-title">ƒêang t·∫£i...</h1>
          <div class="venue-subtitle" id="venue-subtitle">
            <span>ƒêang t·∫£i th√¥ng tin...</span>
          </div>

          <div class="venue-tags" id="venue-tags">
            <!-- Tags will be loaded here -->
          </div>

          <div class="venue-details-grid" id="venue-details">
            <!-- Details will be loaded here -->
          </div>

          <section>
            <h2 class="section-title">M√¥ t·∫£</h2>
            <div class="section-content" id="venue-description">
              <p>ƒêang t·∫£i...</p>
            </div>
          </section>

          <section class="reviews-section">
            <h2 class="section-title" id="reviews-title">ƒê√°nh gi√° (0)</h2>
            <div id="reviews-container">
              <!-- Reviews will be loaded here -->
            </div>
            <a href="#" class="section-link" style="display: block; margin-top: 16px;" id="view-all-reviews">Xem t·∫•t c·∫£ ƒë√°nh gi√° ‚Üí</a>
          </section>
        </div>

        <div>
          <div class="booking-card" id="booking-card">
            <div class="booking-price" id="booking-price">
              ƒêang t·∫£i...
            </div>
            <div style="font-size: 13px; color: var(--muted); margin-bottom: 16px;">
              Gi√° c√≥ th·ªÉ thay ƒë·ªïi theo khung gi·ªù
            </div>
            <button class="btn booking-cta" id="book-btn" onclick="goToBooking()">
              Ch·ªçn gi·ªù & ƒê·∫∑t s√¢n
            </button>
            <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border);">
              <div style="font-size: 13px; margin-bottom: 8px; font-weight: 600;">Th√¥ng tin li√™n h·ªá</div>
              <div style="font-size: 13px; color: var(--muted); margin-bottom: 4px;" id="venue-phone">üìû ƒêang t·∫£i...</div>
              <button class="btn-outline" style="width: 100%; margin-top: 8px;">
                üí¨ Chat v·ªõi ch·ªß s√¢n
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <div class="container">
      <div class="footer-grid">
        <div>
          <div class="footer-logo">
            <svg class="logo-icon" viewBox="0 0 64 64" aria-hidden="true">
              <defs>
                <linearGradient id="sf-pin-footer" x1="0" y1="0" x2="1" y2="1">
                  <stop offset="0%" stop-color="#16a34a" />
                  <stop offset="100%" stop-color="#15803d" />
                </linearGradient>
              </defs>
              <path d="M32 4C22 4 14 12 14 22.2c0 11.2 9.7 22.3 16.2 30 1 1.2 2.7 1.2 3.7 0C40.3 44.5 50 33.4 50 22.2 50 12 42 4 32 4Z" fill="none" stroke="url(#sf-pin-footer)" stroke-width="4" />
              <path d="M18 26h28" stroke="#16a34a" stroke-width="3" stroke-linecap="round" />
              <path d="M32 26v16" stroke="#16a34a" stroke-width="3" stroke-linecap="round" />
              <path d="M24 18l5 5 9-9" fill="none" stroke="#2563eb" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <span class="brand-name">SportField</span>
          </div>
          <p class="section-sub">
            N·ªÅn t·∫£ng ƒë·∫∑t s√¢n th·ªÉ thao ƒëa m√¥n, gi√∫p b·∫°n k·∫øt n·ªëi d·ªÖ d√†ng v·ªõi h√†ng trƒÉm s√¢n t·∫≠p tr√™n to√†n qu·ªëc.
          </p>
        </div>

        <div>
          <div class="footer-title">Quy ƒë·ªãnh & h·ªó tr·ª£</div>
          <div class="footer-links">
            <a href="dieu-khoan.html">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a>
            <a href="dieu-khoan.html#privacy">Ch√≠nh s√°ch b·∫£o m·∫≠t</a>
            <a href="ho-tro.html">H∆∞·ªõng d·∫´n ƒë·∫∑t s√¢n</a>
            <a href="ho-tro.html">H·ªó tr·ª£ kh√°ch h√†ng</a>
          </div>
        </div>

        <div>
          <div class="footer-title">Li√™n h·ªá</div>
          <div class="footer-links">
            <span>Email: support@sportfield.vn</span>
            <span>Hotline: 0900 000 000</span>
            <span>Gi·ªù l√†m vi·ªác: 8:00 ‚Äì 22:00</span>
          </div>
        </div>
      </div>

      <div class="footer-bottom">
        <span>¬© 2025 SportField. All rights reserved.</span>
        <span>Made with ‚ù§Ô∏è for sport lovers.</span>
      </div>
    </div>
  </footer>

  <script src="assets/js/mockData.js"></script>
  <script src="assets/js/api.js"></script>
  <script src="assets/js/header.js"></script>
  <script src="assets/js/alert.js"></script>
  <script>
    let currentVenue = null;
    let venueId = 1; // Default

    // Get venue ID from URL
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('id')) {
      venueId = parseInt(urlParams.get('id'));
    }

    // Load venue data on page load
    document.addEventListener('DOMContentLoaded', async function() {
      await loadVenue();
      await loadReviews();
    });

    // Load venue details
    async function loadVenue() {
      currentVenue = await getVenueById(venueId);
      
      if (!currentVenue) {
        document.getElementById('venue-title').textContent = 'Kh√¥ng t√¨m th·∫•y s√¢n';
        return;
      }

      // Update breadcrumb
      document.getElementById('breadcrumb-venue').textContent = currentVenue.name;

      // Update title
      document.getElementById('venue-title').textContent = currentVenue.name;

      // Update subtitle
      const price = new Intl.NumberFormat('vi-VN').format(currentVenue.basePrice);
      document.getElementById('venue-subtitle').innerHTML = `
        <span>üìç ${currentVenue.district}, ${currentVenue.city}</span>
        <span class="venue-rating">‚òÖ ${currentVenue.rating} (${currentVenue.totalReviews} ƒë√°nh gi√°)</span>
        <span>${currentVenue.distance || 'N/A'} km t·ª´ v·ªã tr√≠ c·ªßa b·∫°n</span>
      `;

      // Update tags
      const tagsHtml = `
        <span class="venue-tag">${currentVenue.sportTypeName}</span>
        ${currentVenue.amenities.map(a => `<span class="venue-tag">${a}</span>`).join('')}
      `;
      document.getElementById('venue-tags').innerHTML = tagsHtml;

      // Update details
      const hours = `${currentVenue.hours.start.toString().padStart(2, '0')}:00 - ${currentVenue.hours.end.toString().padStart(2, '0')}:00`;
      document.getElementById('venue-details').innerHTML = `
        <div class="detail-item">
          <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span>${hours} h√†ng ng√†y</span>
        </div>
        <div class="detail-item">
          <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
          <span>${currentVenue.address}</span>
        </div>
        <div class="detail-item">
          <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
          </svg>
          <span>${currentVenue.fields.length} s√¢n</span>
        </div>
        <div class="detail-item">
          <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
          <span>C√≥ ph√≤ng thay ƒë·ªì & WC</span>
        </div>
      `;

      // Update description
      document.getElementById('venue-description').innerHTML = `
        <p>${currentVenue.description}</p>
        <p style="margin-top: 12px;">
          <strong>Ti·ªán √≠ch:</strong> ${currentVenue.amenities.join(', ')}.
        </p>
      `;

      // Update booking card
      document.getElementById('booking-price').innerHTML = `
        ${price}‚Ç´<span class="booking-price-unit">/gi·ªù</span>
      `;
      document.getElementById('venue-phone').textContent = `üìû ${currentVenue.phone}`;

      // Update images
      if (currentVenue.images && currentVenue.images.length > 0) {
        // L∆∞u index ·∫£nh ch√≠nh hi·ªán t·∫°i (m·∫∑c ƒë·ªãnh l√† 0)
        if (!currentVenue.currentMainIndex) {
          currentVenue.currentMainIndex = 0;
        }
        
        const mainImage = document.getElementById('main-image');
        const mainIndex = currentVenue.currentMainIndex;
        mainImage.src = currentVenue.images[mainIndex];
        mainImage.alt = currentVenue.name;

        const thumbsContainer = document.getElementById('gallery-thumbs');
        
        // Hi·ªÉn th·ªã c√°c ·∫£nh c√≤n l·∫°i l√†m thumbnails (tr·ª´ ·∫£nh ch√≠nh)
        const thumbImages = currentVenue.images
          .map((img, index) => ({ img, index }))
          .filter(item => item.index !== mainIndex)
          .slice(0, 2); // Ch·ªâ l·∫•y t·ªëi ƒëa 2 ·∫£nh
        
        if (thumbImages.length > 0) {
          thumbsContainer.innerHTML = thumbImages.map((item) => `
            <img 
              src="${item.img}" 
              alt="Thumbnail" 
              class="gallery-thumb" 
              onclick="swapImage(${item.index})" 
              data-image-index="${item.index}"
            />
          `).join('');
          
          // ƒêi·ªÅu ch·ªânh grid rows d·ª±a tr√™n s·ªë l∆∞·ª£ng thumbnail ƒë·ªÉ chia ƒë·ªÅu chi·ªÅu cao
          if (thumbImages.length === 1) {
            thumbsContainer.style.gridTemplateRows = '1fr';
          } else {
            thumbsContainer.style.gridTemplateRows = '1fr 1fr';
            thumbsContainer.style.height = '100%';
          }
        } else {
          thumbsContainer.innerHTML = '';
        }
      }
    }

    // Load reviews
    async function loadReviews() {
      const reviews = await getVenueReviews(venueId);
      const container = document.getElementById('reviews-container');
      
      document.getElementById('reviews-title').textContent = `ƒê√°nh gi√° (${reviews.length})`;
      
      if (reviews.length === 0) {
        container.innerHTML = `
          <div style="text-align: center; padding: 40px; color: var(--muted);">
            Ch∆∞a c√≥ ƒë√°nh gi√° n√†o
          </div>
        `;
        return;
      }

      container.innerHTML = reviews.slice(0, 2).map(review => {
        const date = new Date(review.date);
        const dateStr = date.toLocaleDateString('vi-VN');
        const daysAgo = Math.floor((new Date() - date) / (1000 * 60 * 60 * 24));
        const timeAgo = daysAgo === 0 ? 'H√¥m nay' : daysAgo === 1 ? 'H√¥m qua' : `${daysAgo} ng√†y tr∆∞·ªõc`;
        
        return `
          <div class="review-card">
            <div class="review-header">
              <div>
                <div class="review-author">${review.userName}</div>
                <div class="venue-rating" style="font-size: 14px;">‚òÖ ${review.rating}</div>
              </div>
              <div class="review-date">${timeAgo}</div>
            </div>
            <p style="font-size: 14px; margin-top: 8px; line-height: 1.6;">
              ${review.comment}
            </p>
          </div>
        `;
      }).join('');
    }

    // Swap image khi click v√†o thumbnail - ·∫£nh ƒë∆∞·ª£c click tr·ªü th√†nh ·∫£nh ch√≠nh
    function swapImage(imageIndex) {
      if (!currentVenue || !currentVenue.images || imageIndex >= currentVenue.images.length) {
        return;
      }
      
      // C·∫≠p nh·∫≠t index ·∫£nh ch√≠nh
      currentVenue.currentMainIndex = imageIndex;
      
      // Reload l·∫°i gallery v·ªõi ·∫£nh ch√≠nh m·ªõi
      const mainImage = document.getElementById('main-image');
      mainImage.src = currentVenue.images[imageIndex];
      mainImage.alt = currentVenue.name;

      const thumbsContainer = document.getElementById('gallery-thumbs');
      
      // Hi·ªÉn th·ªã c√°c ·∫£nh c√≤n l·∫°i l√†m thumbnails (tr·ª´ ·∫£nh ch√≠nh m·ªõi)
      const thumbImages = currentVenue.images
        .map((img, index) => ({ img, index }))
        .filter(item => item.index !== imageIndex)
        .slice(0, 2); // Ch·ªâ l·∫•y t·ªëi ƒëa 2 ·∫£nh
      
      if (thumbImages.length > 0) {
        thumbsContainer.innerHTML = thumbImages.map((item) => `
          <img 
            src="${item.img}" 
            alt="Thumbnail" 
            class="gallery-thumb" 
            onclick="swapImage(${item.index})" 
            data-image-index="${item.index}"
          />
        `).join('');
        
        // ƒêi·ªÅu ch·ªânh grid rows d·ª±a tr√™n s·ªë l∆∞·ª£ng thumbnail ƒë·ªÉ chia ƒë·ªÅu chi·ªÅu cao
        if (thumbImages.length === 1) {
          thumbsContainer.style.gridTemplateRows = '1fr';
        } else {
          thumbsContainer.style.gridTemplateRows = '1fr 1fr';
          thumbsContainer.style.height = '100%';
        }
      } else {
        thumbsContainer.innerHTML = '';
      }
    }

    // Go to booking page
    function goToBooking() {
      if (currentVenue) {
        window.location.href = `bang-lich-trong.html?venue=${currentVenue.id}`;
      } else {
        alert('ƒêang t·∫£i th√¥ng tin s√¢n...');
      }
    }
  </script>
</body>
</html>

